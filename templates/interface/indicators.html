{% extends "interface/base.html" %}

{% block main %}
<div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <div class="content-header">
        <div class="container-fluid">
            <div class="row mb-2">
                <div class="col-sm-6">
                    <h1 class="m-0">Indicators</h1>
                </div><!-- /.col -->
                <div class="col-sm-6">
                    <ol class="breadcrumb float-sm-right">
                        <li class="breadcrumb-item"><a href="#">Home</a></li>
                        <li class="breadcrumb-item active">Indicators</li>
                    </ol>
                </div><!-- /.col -->
            </div><!-- /.row -->
        </div><!-- /.container-fluid -->

        <div class="container-fluid">
            <div class="col-lg-12">
                <div class="card">
                    <div class="card-header">
                        <large class="card-title">
                            <div class="row no-print">
                                <div class="col-12">
                                    <button class="btn btn-primary float-right" type="button"
                                        id="new_application"><i class="fa fa-plus"></i> Add New Indicators</button>
                                    <dialog id="myDialog"
                                        style="width: 50%; height: 120%; background-color: white; z-index:1000001;">
                                        <div class="card" style="background-color: white; color: dark;">
                                            <div class="card-header bg-primary" >
                                                <div class="card-title">
                                                    <h3>New Indicator</h3>
                                                </div>

                                            </div>
                                            <div class="card-body">
                                                <form id="indicatorForm">
                                                    <div class="form-group">
                                                        <label for="objectiveCode">Objective Code</label>
                                                        <select class="form-control" id="objectiveCode">
                                                            <!-- Options for Objective Code -->
                                                            <option value="code1">Code A</option>
                                                            <option value="code2">Code B</option>
                                                            <!-- Add more options as needed -->
                                                        </select>
                                                    </div>
                                                    <div class="form-group">
                                                        <label for="indicatorName">Indicator Name</label>
                                                        <textarea class="form-control" id="indicatorName" placeholder="Indicator Name" rows="3"></textarea>
                                                    </div>
                                                    <div class="form-group">
                                                        <label for="type">Type</label>
                                                        <select class="form-control" id="type">
                                                            <!-- Options for Type -->
                                                            <option value="type1">number</option>
                                                            <option value="type2">words</option>
                                                            <!-- Add more options as needed -->
                                                        </select>
                                                    </div>
                                                    <div class="form-group">
                                                        <label for="frequency">Frequency</label>
                                                        <select class="form-control" id="frequency">
                                                            <!-- Options for Frequency -->
                                                            <option value="monthly">Monthly</option>
                                                            <option value="quarterly">Quarterly</option>
                                                            <option value="annually">Annually</option>
                                                            <!-- Add more options as needed -->
                                                        </select>
                                                    </div>
                                                    <div class="card-footer">
                                                        <button type="submit" class="btn btn-primary">Submit</button>
                                                        <button id="closeDialogBtn" class="btn btn-danger" style="float: right;" autofocus>&times; Cancel</button>
                                                    </div>
                                                </form>
                                            </div>

                                    </dialog>
                                    <button type="button" class="btn btn-primary float-right"
                                        style="margin-right: 5px;">
                                        <i class="fas fa-download"></i> Generate PDF
                                    </button>
                                </div>
                            </div>
                        </large>

                    </div>
                    <div class="table-responsive">
                    <div class="table">
                        <table id="indicatorTable" class="table table-bordered">
                            <colgroup>
                                <col width="5%">
                                <col width="20%">
                                <col width="25%">
                                <col width="20%">
                                <col width="20%">
                            </colgroup>
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Objective Code</th>
                                    <th>Indicator Name</th>
                                    <th>Type</th>
                                    <th>Frequency</th>
                                    <th>Actions</th> <!-- Action column header -->
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Objective rows will be inserted here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>

    <style>
        table {
            width: 100%;
            table-layout: fixed;
        }
        table th, table td {
            word-wrap: break-word;
            white-space: normal;
        }
    </style>
   
    <script>
        const openDialogBtn = document.getElementById('new_application');
        const myDialog = document.getElementById("myDialog");
        const closeDialogBtn = document.getElementById('closeDialogBtn');
        
        // Event listener to open the dialog
        openDialogBtn.addEventListener('click', () => {
            myDialog.showModal();
        });
        
        // Event listener to close the dialog
        closeDialogBtn.addEventListener('click', () => {
            myDialog.close();
        });
        
        document.getElementById('indicatorForm').addEventListener('submit', function(event) {
            event.preventDefault();
        
            // Get input values
            var objectiveCode = document.getElementById('objectiveCode').value;
            var indicatorName = document.getElementById('indicatorName').value;
            var type = document.getElementById('type').value;
            var frequency = document.getElementById('frequency').value;
        
            // Add row to table
            var table = document.getElementById('objectiveTable').getElementsByTagName('tbody')[0];
            var newRow = table.insertRow();
            var cellId = newRow.insertCell(0);
            var cellCode = newRow.insertCell(1);
            var cellIndicator = newRow.insertCell(2);
            var cellType = newRow.insertCell(3);
            var cellFrequency = newRow.insertCell(4);
            var cellActions = newRow.insertCell(5); // New cell for actions
            cellId.innerHTML = table.rows.length; // ID starts from 1
            cellCode.innerHTML = objectiveCode;
            cellIndicator.innerHTML = indicatorName;
            cellType.innerHTML = type;
            cellFrequency.innerHTML = frequency;
            cellActions.innerHTML = '<button class="btn btn-primary edit-btn">Edit</button> <button class="btn btn-danger delete-btn">Delete</button>';
        
            // Clear form fields
            document.getElementById('indicatorForm').reset();
        
            // Display table
            document.getElementById('tableContainer').style.display = 'block';
        });
        
        document.getElementById('closeDialogBtn').addEventListener('click', function(event) {
            event.preventDefault(); // Prevent the default behavior of the button (form submission)
        
            // Clear form fields
            document.getElementById('indicatorForm').reset();
        
            // Hide form and display table
            document.getElementById('tableContainer').style.display = 'block';
        });
        
        // Handle delete and edit actions
        document.getElementById('objectiveTable').addEventListener('click', function(event) {
            if (event.target.classList.contains('delete-btn')) {
                var row = event.target.closest('tr');
                row.remove();
            } else if (event.target.classList.contains('edit-btn')) {
                var row = event.target.closest('tr');
                var cells = row.getElementsByTagName('td');
                var objectiveCode = cells[1].innerHTML;
                var indicatorName = cells[2].innerHTML;
                var type = cells[3].innerHTML;
                var frequency = cells[4].innerHTML;
        
                // Populate form fields for editing
                document.getElementById('objectiveCode').value = objectiveCode;
                document.getElementById('indicatorName').value = indicatorName;
                document.getElementById('type').value = type;
                document.getElementById('frequency').value = frequency;
        
                // Hide form and display table
                document.getElementById('tableContainer').style.display = 'none';
                document.getElementById('indicatorForm').style.display = 'block';
        
                // Remove row from table
                row.remove();
            }
        });
        
        document.getElementById('tableContainer').style.display = 'none'; // Hide table initially
    </script>
{% endblock main %}
